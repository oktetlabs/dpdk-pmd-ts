<?xml version="1.0"?>
<!-- SPDX-License-Identifier: Apache-2.0 -->
<!-- (c) Copyright 2016 - 2022 Xilinx, Inc. All rights reserved. -->
<package version="1.0">
    <description>Performance</description>

    <author mailto="Igor.Romanov@oktetlabs.ru"/>

    <req id="PERF"/>

    <session track_conf="silent" track_conf_handdown="descendants">
        <!--- @autogroupall dpdk_pmd_params -->
        <var name="env.perf.iut_only" global="true">
            <value>'net':IUT{
                'iut_host'{
                    {'iut_jobs_ctrl':tester, if:'iut_port'}
                }
            }</value>
        </var>

        <!--- @autogroupall dpdk_pmd_params -->
        <var name="env.perf.peer2peer" global="true">
            <value>'net':IUT{
                'iut_host'{
                    {'iut_jobs_ctrl':tester, if:'iut_port'}
                },
                'tst_host'{
                    {'tst_jobs_ctrl':tester, if:'tst_port'}
                }
            },'iut_port0'='iut_port','tst_port0'='tst_port'</value>
        </var>

        <var name="env.perf.peer2peerX2" global="true">
            <value reqs="TWO_PARALLEL_LINKS">'net1':IUT{
                'iut_host'{
                    'iut_ps'{'iut_jobs_ctrl':tester, if:'iut_port0'}
                },
                'tst_host'{
                    'tst_ps'{'tst_jobs_ctrl':tester, if:'tst_port0'}
                }
            },
            'net2':IUT{
                'iut_host'{
                    'iut_ps'{if:'iut_port1'}
                },
                'tst_host'{
                    'tst_ps'{if:'tst_port1'}
                }
            }</value>
        </var>

        <var name="env.perf.peer2peerX4" global="true">
            <value reqs="FOUR_PARALLEL_LINKS">'net1':IUT{
                'iut_host'{
                    'iut_ps'{'iut_jobs_ctrl':tester, if:'iut_port0'}
                },
                'tst_host'{
                    'tst_ps'{'tst_jobs_ctrl':tester, if:'tst_port0'}
                }
            },
            'net2':IUT{
                'iut_host'{
                    'iut_ps'{if:'iut_port1'}
                },
                'tst_host'{
                    'tst_ps'{if:'tst_port1'}
                }
            },
            'net3':IUT{
                'iut_host'{
                    'iut_ps'{if:'iut_port2'}
                },
                'tst_host'{
                    'tst_ps'{if:'tst_port2'}
                }
            },
            'net4':IUT{
                'iut_host'{
                    'iut_ps'{if:'iut_port3'}
                },
                'tst_host'{
                    'tst_ps'{if:'tst_port3'}
                }
            }</value>
        </var>

        <!--- @autogroupprefix perf- -->
        <prologue>
            <script name="perf_prologue"/>
            <arg name="env0" ref="env.perf.peer2peerX4"/>
            <arg name="env1" ref="env.perf.peer2peerX2"/>
            <arg name="env2" ref="env.perf.peer2peer"/>
        </prologue>

        <!--- @autogroup -->
        <run>
            <script name="testpmd_loopback"/>
            <arg name="env">
                <value ref="env.perf.iut_only"/>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>io</value>
            </arg>
            <arg name="testpmd_arg_tx_first">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_command_txpkts">
                <value>60</value>
                <value>124</value>
                <value>252</value>
                <value>508</value>
                <value>1020</value>
                <value>1514</value>
                <value>2044</value>
                <value>4092</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
            <arg name="testpmd_arg_rxfreet">
                <value>0</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
            <arg name="n_fwd_cores">
                <value>1</value>
            </arg>
            <arg name="testpmd_command_loopback_mode">
                <value>1</value>
                <value>3</value>
                <value>27</value>
                <value>29</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run name="testpmd_txonly">
            <script name="testpmd_txonly"/>
            <arg name="env">
                <value ref="env.perf.peer2peer"/>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_txpkts">
                <value>42</value>
                <value>60</value>
                <value>124</value>
                <value>252</value>
                <value>508</value>
                <value>1020</value>
                <value>1514</value>
                <value>42,1472</value>
                <value>2044</value>
                <value>4092</value>
                <value>1700,1700,500</value>
                <value>9014</value>
                <value>1728,1728,1728,1728,1728,374</value>
            </arg>
            <arg name="testpmd_arg_txq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_fwd_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>4</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
                <value>64</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
        </run>

        <run name="testpmd_dual_port_txonly">
            <script name="testpmd_txonly">
                <objective>Test dpdk-testpmd performance in Tx only mode on two ports simultaneously</objective>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peerX2"/>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_txpkts">
                <value>60</value>
                <value>1514</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_txq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_fwd_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>4</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
        </run>

        <run name="testpmd_four_port_txonly">
            <script name="testpmd_txonly">
                <objective>Test dpdk-testpmd performance in Tx only mode on four ports simultaneously</objective>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peerX4"/>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_txpkts">
                <value>60</value>
                <value>1514</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_txq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_fwd_cores" list="cores">
                <value>4</value>
                <value>4</value>
                <value>8</value>
                <value>8</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
        </run>

        <run name="testpmd_txonly_tso">
            <script name="testpmd_txonly"/>
            <arg name="env">
                <value ref="env.perf.peer2peer"/>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_txpkts">
                <value>4096</value>
                <value>29254</value>
            </arg>
            <arg name="testpmd_arg_txonly_tso_mss">
                <value>1460</value>
            </arg>
            <arg name="testpmd_arg_txq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_fwd_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>4</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
                <value>64</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
        </run>

        <run name="testpmd_txonly_tso_multiseg">
            <script name="testpmd_txonly"/>
            <arg name="env">
                <value ref="env.perf.peer2peer"/>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
            </arg>
            <arg name="testpmd_command_txpkts">
                <value>54,1460</value>
                <value>54,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460,1460</value>
                <value>54,2920,2920,2920,2920,2920,2920,2920,2920,2920,2920</value>
                <value>54,4096,4096,4096,4096,4096,4096,4096,528</value>
                <value>54,4096,4096,4096,4096,4096,4096,4096,4096,4096,4096</value>
            </arg>
            <arg name="testpmd_arg_txonly_tso_mss">
                <value>1460</value>
            </arg>
            <arg name="testpmd_arg_txq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_fwd_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>4</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
                <value>64</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run>
            <script name="testpmd_rxonly">
                <req id="DPDK_PEER"/>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peer"/>
            </arg>
            <arg name="generator_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>rxonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="packet_size">
                <value>42</value>
                <value>60</value>
                <value>124</value>
                <value>252</value>
                <value>508</value>
                <value>1020</value>
                <value>1514</value>
                <value>2044</value>
                <value>4092</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_rxq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_rx_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
                <value>64</value>
            </arg>
            <arg name="testpmd_arg_rxfreet">
                <value>0</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run name="testpmd_dual_port_rxonly">
            <script name="testpmd_rxonly">
                <req id="DPDK_PEER"/>
                <objective>Test dpdk-testpmd performance in Rx only mode on two ports simultaneously</objective>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peerX2"/>
            </arg>
            <arg name="generator_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>rxonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="packet_size">
                <value>60</value>
                <value>1514</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_rxq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_rx_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
            <arg name="testpmd_arg_rxfreet">
                <value>0</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run name="testpmd_four_port_rxonly">
            <script name="testpmd_rxonly">
                <req id="DPDK_PEER"/>
                <objective>Test dpdk-testpmd performance in Rx only mode on four ports simultaneously</objective>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peerX4"/>
            </arg>
            <arg name="generator_mode">
                <value>txonly</value>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>rxonly</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>off</value>
                <value>on</value>
            </arg>
            <arg name="packet_size">
                <value>60</value>
                <value>1514</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_rxq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_rx_cores" list="cores">
                <value>4</value>
                <value>4</value>
                <value>8</value>
                <value>8</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
            <arg name="testpmd_arg_rxfreet">
                <value>0</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run name="testpmd_dual_port_fwd">
            <script name="testpmd_fwd">
                <req id="DPDK_PEER"/>
                <objective>Test dpdk-testpmd performance in IO forwarding mode on two ports simultaneously</objective>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peerX2"/>
            </arg>
            <arg name="generator_mode">
                <value>flowgen</value>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>io</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>on</value>
            </arg>
            <arg name="packet_size">
                <value>60</value>
                <value>124</value>
                <value>252</value>
                <value>508</value>
                <value>1020</value>
                <value>1514</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_rxq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_cores" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run name="testpmd_four_port_fwd">
            <script name="testpmd_fwd">
                <req id="DPDK_PEER"/>
                <objective>Test dpdk-testpmd performance in IO forwarding mode on four ports simultaneously</objective>
            </script>
            <arg name="env">
                <value ref="env.perf.peer2peerX4"/>
            </arg>
            <arg name="generator_mode">
                <value>flowgen</value>
            </arg>
            <arg name="testpmd_arg_forward_mode">
                <value>io</value>
            </arg>
            <arg name="testpmd_arg_stats_period">
                <value>1</value>
            </arg>
            <arg name="testpmd_arg_no_lsc_interrupt">
                <value>TRUE</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_autoneg" list="flow_ctrl">
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_rx" list="flow_ctrl">
                <value>on</value>
            </arg>
            <arg name="testpmd_command_flow_ctrl_tx" list="flow_ctrl">
                <value>on</value>
            </arg>
            <arg name="packet_size">
                <value>60</value>
                <value>124</value>
                <value>252</value>
                <value>508</value>
                <value>1020</value>
                <value>1514</value>
                <value>9014</value>
            </arg>
            <arg name="testpmd_arg_rxq" list="cores">
                <value>1</value>
                <value>2</value>
                <value>4</value>
                <value>8</value>
            </arg>
            <arg name="n_cores" list="cores">
                <value>4</value>
                <value>4</value>
                <value>8</value>
                <value>8</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
        </run>

        <!--- @autogroup -->
        <run>
            <script name="l2fwd_simple"/>
            <arg name="env">
                <value ref="env.perf.peer2peer"/>
            </arg>
            <arg name="generator_mode">
                <value>flowgen</value>
            </arg>
            <arg name="testpmd_arg_txd">
                <value>512</value>
            </arg>
            <arg name="testpmd_arg_burst">
                <value>32</value>
            </arg>
            <arg name="testpmd_arg_txfreet">
                <value>0</value>
            </arg>
            <arg name="n_l2fwd_fwd_cores">
                <value>1</value>
            </arg>
            <arg name="packet_size">
                <value reqs="TEST_HARNESS_CHECKUP">42</value>
                <value>60</value>
                <value>124</value>
                <value>252</value>
                <value>508</value>
                <value>1020</value>
                <value>1514</value>
            </arg>
        </run>

    </session>
</package>
